plugins {
    id 'com.android.application'
    id 'kotlin-android'
    id 'kotlin-kapt'
    id 'dagger.hilt.android.plugin'
}

android {
    compileSdk 31

    defaultConfig {
        applicationId "com.rick.budgetly"
        minSdk 26
        targetSdk 31
        versionCode 1

        javaCompileOptions {
            annotationProcessorOptions {
                arguments += [
                        "room.schemaLocation":"$projectDir/schemas".toString(),
                        "room.incremental":"true",
                        "room.expandProjection":"true"]
            }
        }

        testInstrumentationRunner "com.rick.budgetly.HiltTestRunner"
        vectorDrawables {
            useSupportLibrary true
        }
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
    kotlinOptions {
        jvmTarget = '1.8'
        useIR = true
    }
    buildFeatures {
        compose true
    }
    composeOptions {
        kotlinCompilerExtensionVersion compose_version
    }
    packagingOptions {
        resources {
            excludes += '/META-INF/{AL2.0,LGPL2.1}'
        }
    }
    namespace 'com.rick.budgetly'
}

dependencies {

//    implementation project(Modules.core)
//
//    implementation project(Modules.account_accounts)
//    implementation project(Modules.account_add_edit)
//    implementation project(Modules.account_details)
//    implementation project(Modules.account_data)
//    implementation project(Modules.account_components)
//
//    implementation project(Modules.bill_bills)
//    implementation project(Modules.bill_components)
//    implementation project(Modules.bill_data)
//
//    implementation project(Modules.options_options)
//    implementation project(Modules.options_overview)
//    implementation project(Modules.options_settings)
//
//    implementation project(Modules.options_categories)
//    implementation project(Modules.options_categories_data)
//    implementation project(Modules.options_categories_screen)
//
//    implementation project(Modules.options_transaction)
//    implementation project(Modules.options_categories_data)
//    implementation project(Modules.options_transaction_screen)

    implementation Deps.androidxCore
    implementation Deps.appCompat
    implementation Deps.composeMaterial
    implementation Deps.compose
    implementation Deps.composeUi
    implementation Deps.material
    implementation Deps.lifecycle
    implementation Deps.activityCompose

    implementation Deps.livedata
    implementation Deps.constraint
    implementation Deps.viewmodel
    implementation Deps.navigation
    implementation Deps.hiltNav
    implementation Deps.extraIcons
    implementation Deps.coroutines
    implementation Deps.coroutinesCore

    implementation Deps.hilt
    kapt Deps.hiltGoogleCompiler
    implementation Deps.hiltViewmodel
    kapt Deps.hiltCompiler

    implementation Deps.roomRuntime
    kapt Deps.roomCompiler
    implementation Deps.roomExtensions

    implementation Deps.coil
    implementation Deps.retrofit
    implementation Deps.gson
    
    // Tests
    androidTestImplementation 'androidx.test.ext:junit:1.1.3'
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.4.0'
    androidTestImplementation "androidx.compose.ui:ui-test-junit4:$compose_version"
    debugImplementation "androidx.compose.ui:ui-tooling:$compose_version"

    // Local unit tests
    testImplementation "androidx.test:core:1.4.0"
    testImplementation "junit:junit:4.13.2"
    testImplementation "androidx.arch.core:core-testing:2.1.0"
    testImplementation "org.jetbrains.kotlinx:kotlinx-coroutines-test:1.6.0"
    testImplementation "com.google.truth:truth:1.1.3"
    testImplementation "com.squareup.okhttp3:mockwebserver:4.9.1"
    testImplementation "io.mockk:mockk:1.10.5"
    debugImplementation "androidx.compose.ui:ui-test-manifest:1.2.0-beta01"

    testImplementation 'com.nhaarman.mockitokotlin2:mockito-kotlin:2.1.0'
    testImplementation 'org.mockito:mockito-inline:2.21.0'

    // Instrumentation tests
    androidTestImplementation "com.google.dagger:hilt-android-testing:2.40.1"
    kaptAndroidTest 'com.google.dagger:hilt-android-compiler:2.37'
    androidTestImplementation "junit:junit:4.13.2"
    androidTestImplementation "org.jetbrains.kotlinx:kotlinx-coroutines-test:1.6.1"
    androidTestImplementation "androidx.arch.core:core-testing:2.1.0"
    androidTestImplementation "com.google.truth:truth:1.1.3"
    androidTestImplementation 'androidx.test.ext:junit:1.1.3'
    androidTestImplementation 'androidx.test:core-ktx:1.4.0'
    androidTestImplementation "com.squareup.okhttp3:mockwebserver:4.9.1"
    androidTestImplementation 'androidx.test:runner:1.4.0'
}